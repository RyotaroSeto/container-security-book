# 第6章 セキュアなコンテナ環境の高知機

## 6.1 コンテナのセキュリティ監視
コンテナ自体の関連するログやイベントの監視も重要だが、ホスト側のセキュリティモニタリングも大切

### 監視対象を整理する
- どのようなシステムであっても全てのログを取得・監視できれば理想だが、それは金銭・運用コストなどから非常に難しい
- そのため、何を監視すべきか整理することが重要

| 攻撃例 | 監視対象 |
| ---- | ---- |
| Docker APIへのアクセス | Docker APIへのアクセスログの監視、Dockerのイベント監視 |
| アプリケーションへの攻撃 | アプリケーションログの監視 |
| ホスト側へのエスケープ | 実行されるコンテナ設定の監視、コンテナ内で実行されるコマンドの監視 |
| 悪意あるイメージの使用 | Dockerのイベント監視 |

- 他にも以下のような場合、防止することが望ましい
  - 無効な、または予期せぬプロセスの実行
  - 無効な、または予期せぬシステムコール
  - 保護された設定ファイルとバイナリの変更
  - 予期せぬ場所やファイルタイプへの書き込み
  - 予期せぬネットワークリスナーの作成
  - 予期せぬネットワークの宛先に送信されたトラフィック
  - マルウェアの保存または実行

- しかし難しいのはこれらの監視をどのようなルールで監視するかである。
  - どのようなイベントが発生して、監視が適切にできているかテストをするなど

### コンテナのセキュリティ監視で利用されるソフトウェアの紹介
- [Sysdig](https://github.com/draios/sysdig)
  - 製品もあるが、OSSもある。
- Falco
- Fluentd / Fluent Bit
 
## 6.2 コンテナの操作ログの記録
